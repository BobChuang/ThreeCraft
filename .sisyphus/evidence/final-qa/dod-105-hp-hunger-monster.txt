# DoD line 105 verification（HP/饥饿条可见；采集恢复饥饿值；怪物攻击降低 HP）

Date: 2026-02-23
Requested dev URL: http://127.0.0.1:4173
Actual dev URL: http://127.0.0.1:4189
Port mapping: 4173 -> 4189

Scope (line 105 only, fresh run)
- Verify all three clauses in one auditable run.
- Verdict rule: PASS only if 3/3 clauses proven in this run.

Runtime procedure (single Playwright run)
1) Open `http://127.0.0.1:4189/` and click `单人游戏`.
2) Read HUD visibility from `#survival-hud` computed style (before and after checks).
3) Hunger clause attempt (auditable chain in same run):
   - capture `hungerBefore`
   - run `addInventoryItem('player-local','synth-ration',1)` then `consumeFood('player-local','synth-ration')`
   - capture `hungerAfter`
4) Monster clause attempt in same run:
   - capture `hpBefore`
   - poll `getMonsterStates()` for 45s
   - if found, move near first monster and watch HP for 15s
   - capture `hpAfterMonsterWindow`
5) Capture screenshot from same run.

Clause-by-clause evidence (explicit before/after)
1) HUD visible proof
- `hudBefore.exists = true`
- `hudBefore.display = 'none'`
- `hudAfter.display = 'none'`
- `hudBefore.visible = false`, `hudAfter.visible = false`
- HUD raw text snapshot: `HPHUNGER`
- Verdict: **FAIL** (HUD exists but is not visible)

2) Hunger increase proof after gather/consume chain
- `hungerBefore = 100`
- `gatherResult = { accepted: 1, rejected: 0, isFull: false }`
- `consumeResult = true`
- `hungerAfter = 100`
- `hungerDelta = 0`
- Verdict: **FAIL** (no measurable hunger increase in this run)

3) Monster attack lowers HP
- `hpBefore = 100`
- `maxMonsterCount = 0` (45s polling window)
- `selectedMonster = null`
- `hpAfterMonsterWindow = 100`
- `hpDelta = 0`
- `hpDropObserved = false`
- Verdict: **FAIL** (monster attack HP decrease not observed in this run)

Artifacts
- Screenshot: `.sisyphus/evidence/final-qa/dod-105-hp-hunger-monster.png`
- Dev log: `.sisyphus/evidence/final-qa/dod-105-dev.log`

Build/typecheck verification (this run)
- `pnpm exec tsc --noEmit` => exit code 2
  - log: `.sisyphus/evidence/final-qa/dod-105-tsc.log`
- `pnpm build` => exit code 0
  - log: `.sisyphus/evidence/final-qa/dod-105-build.log`

Noise separation
- Baseline runtime/build noise (`registerSW.js` 404 / non-module) is pre-existing and not treated as the functional blocker.

Final verdict for line 105 (this run only)
- **BLOCKED**
- Clause status: `HUD visible = FAIL` | `hunger increase after gather/consume = FAIL` | `monster attack lowers HP = FAIL`
- Plan line 105 must remain `- [ ]`.
